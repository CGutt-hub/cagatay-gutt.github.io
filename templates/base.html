<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ config.title }}{% endblock title %}</title>
    <link rel="stylesheet" href="{{ get_url(path='style.css') }}">
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="{{ get_url(path='blog/atom.xml') }}">
</head>
<body>
    <header>
        <div class="header-content">
            <div class="header-left">
                <h1><a href="{{ get_url(path='/', lang=lang) }}">√áaƒüatay √ñzcan Jagiello Gutt</a></h1>
                <nav>
                    {% if lang == "de" %}
                    <a href="{{ get_url(path='/', lang='de') }}">startseite</a>
                    <a href="{{ get_url(path='cv/', lang='de') }}">lebenslauf</a>
                    <a href="{{ get_url(path='publications/', lang='de') }}">publikationen</a>
                    <a href="{{ get_url(path='projects/', lang='de') }}">projekte</a>
                    <a href="{{ get_url(path='blog/', lang='de') }}">blog</a>
                    <a href="{{ get_url(path='contact/', lang='de') }}">kontakt</a>
                    {% else %}
                    <a href="{{ get_url(path='/') }}">home</a>
                    <a href="{{ get_url(path='cv/') }}">cv</a>
                    <a href="{{ get_url(path='publications/') }}">publications</a>
                    <a href="{{ get_url(path='projects/') }}">projects</a>
                    <a href="{{ get_url(path='blog/') }}">blog</a>
                    <a href="{{ get_url(path='contact/') }}">contact</a>
                    {% endif %}
                </nav>
            </div>
            <div class="header-right">
                <button id="lang-toggle" class="lang-switch" aria-label="Toggle language">
                    <span class="lang-icon">{% if lang == "de" %}EN{% else %}DE{% endif %}</span>
                </button>
                <button id="theme-toggle" class="theme-switch" aria-label="Toggle theme">
                    <span class="theme-icon">‚òÄÔ∏è</span>
                </button>
            </div>
        </div>
    </header>
    
    <main>
        {% block content %}{% endblock content %}
    </main>
    
    <footer>
        <p class="site-info"><em>This site syncs automatically with GitHub (projects) and ORCID (publications). Last build: {{ now() | date(format="%Y-%m-%d") }}</em></p>
        <div class="contact-links">
            <a href="https://www.linkedin.com/in/cagatay-gutt" target="_blank">LinkedIn</a>
            <a href="https://orcid.org/0000-0002-1774-532X" target="_blank">ORCID</a>
            <a href="https://github.com/CGutt-hub" target="_blank">GitHub</a>
            <a href="{{ get_url(path='blog/atom.xml') }}" target="_blank">RSS</a>
        </div>
        <p>&copy; {{ now() | date(format="%Y") }} √áaƒüatay √ñzcan Jagiello Gutt</p>
    </footer>
    
    <script>
        // Theme switching functionality
        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = document.querySelector('.theme-icon');
        const html = document.documentElement;
        
        // Check for saved theme preference or default to 'dark'
        const savedTheme = localStorage.getItem('theme') || 'dark';
        html.setAttribute('data-theme', savedTheme);
        updateThemeIcon(savedTheme);
        
        themeToggle.addEventListener('click', () => {
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        });
        
        function updateThemeIcon(theme) {
            themeIcon.textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        }

        // Language switching functionality
        const langToggle = document.getElementById('lang-toggle');
        if (langToggle) {
            langToggle.addEventListener('click', () => {
                const currentPath = window.location.pathname;
                const basePath = '{{ config.base_url | safe }}';
                const basePathParsed = new URL(basePath).pathname.replace(/\/$/, '');
                
                // Check if we're on German version
                if (currentPath.includes('/de/') || currentPath.endsWith('/de')) {
                    // Switch to English - remove /de/
                    const newPath = currentPath.replace('/de/', '/').replace(/\/de$/, '/');
                    window.location.href = newPath;
                } else {
                    // Switch to German - add /de/
                    const pathAfterBase = currentPath.replace(basePathParsed, '');
                    const newPath = basePathParsed + '/de' + (pathAfterBase || '/');
                    window.location.href = newPath;
                }
            });
        }
    </script>
</body>
</html>
